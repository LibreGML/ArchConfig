# ══════════════════════════════════════════════════════════════════════════════════════════════
# HYPR配置文件 - Hyprland窗口管理器的主要配置
# ══════════════════════════════════════════════════════════════════════════════════════════════

# ┌─ 变量定义区 ──────────────────────────────────────────────────────────────────────────────────
# 定义常用的路径变量，方便统一管理和修改
$UserConfigs = $HOME/.config/hypr/UserConfigs    # 用户配置文件存放目录
$scriptsDir = $HOME/.config/hypr/scripts        # 系统脚本存放目录
$UserScripts = $HOME/.config/hypr/UserScripts    # 用户自定义脚本目录
wallDIR = $HOME/Pictures/wallpapers             # 壁纸图片存放目录
$lock = $scriptsDir/LockScreen.sh               # 锁屏脚本路径
$SwwwRandom = $UserScripts/WallpaperAutoChange.sh # 自动更换壁纸脚本
$mainMod = SUPER                                # 主修饰键（Win键）
$files = thunar                                 # 文件管理器（Thunar）
$term = kitty                                   # 终端模拟器（Kitty）

# ┌─ 外部配置文件引用 ───────────────────────────────────────────────────────────────────────────
# 引入其他配置文件，实现配置模块化管理
source = $UserConfigs/Laptops.conf              # 笔记本电脑特定配置
source = $UserConfigs/UserDecorAnimations.conf  # 窗口装饰和动画效果配置
source = $UserConfigs/UserSettings.conf         # 用户个性化设置

# ┌─ 显示器设置区 ──────────────────────────────────────────────────────────────────────────────
# 显示器配置 - 自动选择首选分辨率并应用1.33倍缩放
monitor = , preferred, auto, 1.33               # 自动配置显示器，使用1.33倍缩放

# ┌─ 系统服务和应用启动区 ─────────────────────────────────────────────────────────────────────
# 输入法引擎 - 用于中文输入支持
exec-once = fcitx5 -d                           # 启动Fcitx5输入法

# 壁纸管理 - 初始化壁纸服务并随机更换壁纸
exec-once = swww query || swww-daemon --format xrgb  # 启动swww壁纸守护进程
exec-once = $SwwwRandom $wallDIR                # 每30分钟随机更换壁纸

# 系统环境设置 - 为Wayland会话配置必要的环境变量
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = systemctl --user import-environment WAYLAND_DISPLAY XDG_CURRENT_DESKTOP

# 数据库服务 - 启动MySQL数据库（如果需要）
exec-once = sudo systemctl start mysqld         # 启动MySQL数据库服务

# 权限管理 - 启动PolicyKit认证代理
exec-once = $scriptsDir/Polkit.sh               # 启动Polkit权限认证服务

# 启动常用应用程序
exec-once = kitty &                             # 启动Kitty终端
exec-once = waybar &                            # 启动Waybar状态栏
exec-once = nm-applet --indicator &             # 启动网络连接管理器
exec-once = swaync &                            # 启动Sway通知中心
exec-once = ags &                               # 启动Aylur's GTK Shell（状态栏/小部件框架）
exec-once = blueman-applet &                    # 启动蓝牙管理器
exec-once = rog-control-center &                # 启动华硕ROG设备控制中心

# 剪贴板管理 - 为Wayland环境管理文本和图像剪贴板
exec-once = wl-paste --type text --watch cliphist store   # 监听文本剪贴板
exec-once = wl-paste --type image --watch cliphist store  # 监听图像剪贴板

# 视觉效果 - 启动彩虹边框动画效果
exec-once = $UserScripts/RainbowBorders.sh      # 启动彩虹窗口边框效果

# 系统管理 - 启动电源管理和锁屏服务
exec-once = hypridle                            # 启动Hypridle空闲管理器
exec-once = pypr &                              # 启动Pyprland下拉终端守护进程

# ┌─ 窗口管理快捷键区 ──────────────────────────────────────────────────────────────────────────
# 基础窗口操作
bind = $mainMod, C, killactive                  # 关闭当前活动窗口
bind = $mainMod, F, exec, pkill rofi || rofi -show filebrowser -modi filebrowser,run,window,drun  # 打开文件浏览器

# 窗口移动和调整大小
bind = $mainMod CTRL, left, movewindow, l       # 将窗口向左移动
bind = $mainMod CTRL, right, movewindow, r      # 将窗口向右移动
bind = $mainMod CTRL, up, movewindow, u         # 将窗口向上移动
bind = $mainMod CTRL, down, movewindow, d       # 将窗口向下移动

# 使用Win+Shift+方向键调整窗口大小
binde = $mainMod SHIFT, left, resizeactive,-50 0   # 向左缩小窗口宽度50像素
binde = $mainMod SHIFT, right, resizeactive,50 0   # 向右扩大窗口宽度50像素
binde = $mainMod SHIFT, up, resizeactive,0 -50     # 向上缩小窗口高度50像素
binde = $mainMod SHIFT, down, resizeactive,0 50    # 向下扩大窗口高度50像素

# 使用Alt+方向键切换窗口焦点
bind = ALT, left, movefocus, l                  # 将焦点移到左侧窗口
bind = ALT, right, movefocus, r                 # 将焦点移到右侧窗口
bind = ALT, up, movefocus, u                    # 将焦点移到上方窗口
bind = ALT, down, movefocus, d                  # 将焦点移到下方窗口

# 全屏控制
bind = $mainMod, up, fullscreen, 0              # 退出全屏模式
bind = $mainMod, down, fullscreen, 1            # 进入全屏模式

# 特殊工作区管理
bind = $mainMod CTRL, D, movetoworkspace, special  # 将当前窗口移动到特殊工作区
bind = ALT, U, togglespecialworkspace,          # 显示/隐藏特殊工作区

# ┌─ 工作区管理快捷键区 ─────────────────────────────────────────────────────────────────────────
# 使用Ctrl+数字键切换工作区
bind = CTRL, code:10, workspace, 1              # 切换到第1个工作区
bind = CTRL, code:11, workspace, 2              # 切换到第2个工作区
bind = CTRL, code:12, workspace, 3              # 切换到第3个工作区
bind = CTRL, code:13, workspace, 4              # 切换到第4个工作区
bind = CTRL, code:14, workspace, 5              # 切换到第5个工作区
bind = CTRL, code:15, workspace, 6              # 切换到第6个工作区
bind = CTRL, code:16, workspace, 7              # 切换到第7个工作区
bind = CTRL, code:17, workspace, 8              # 切换到第8个工作区
bind = CTRL, code:18, workspace, 9              # 切换到第9个工作区
bind = CTRL, code:19, workspace, 10             # 切换到第10个工作区

# 将窗口移动到指定工作区并跟随切换
bind = $mainMod SHIFT, code:10, movetoworkspace, 1   # 将窗口移到第1个工作区
bind = $mainMod SHIFT, code:11, movetoworkspace, 2   # 将窗口移到第2个工作区
bind = $mainMod SHIFT, code:12, movetoworkspace, 3   # 将窗口移到第3个工作区
bind = $mainMod SHIFT, code:13, movetoworkspace, 4   # 将窗口移到第4个工作区
bind = $mainMod SHIFT, code:14, movetoworkspace, 5   # 将窗口移到第5个工作区
bind = $mainMod SHIFT, code:15, movetoworkspace, 6   # 将窗口移到第6个工作区
bind = $mainMod SHIFT, code:16, movetoworkspace, 7   # 将窗口移到第7个工作区
bind = $mainMod SHIFT, code:17, movetoworkspace, 8   # 将窗口移到第8个工作区
bind = $mainMod SHIFT, code:18, movetoworkspace, 9   # 将窗口移到第9个工作区
bind = $mainMod SHIFT, code:19, movetoworkspace, 10  # 将窗口移到第10个工作区
bind = $mainMod SHIFT, bracketleft, movetoworkspace, -1   # 将窗口移到上一个工作区
bind = $mainMod SHIFT, bracketright, movetoworkspace, +1  # 将窗口移到下一个工作区

# 将窗口移动到指定工作区但不跟随切换
bind = $mainMod CTRL, code:10, movetoworkspacesilent, 1  # 静默移到第1个工作区
bind = $mainMod CTRL, code:11, movetoworkspacesilent, 2  # 静默移到第2个工作区
bind = $mainMod CTRL, code:12, movetoworkspacesilent, 3  # 静默移到第3个工作区
bind = $mainMod CTRL, code:13, movetoworkspacesilent, 4  # 静默移到第4个工作区
bind = $mainMod CTRL, code:14, movetoworkspacesilent, 5  # 静默移到第5个工作区
bind = $mainMod CTRL, code:15, movetoworkspacesilent, 6  # 静默移到第6个工作区
bind = $mainMod CTRL, code:16, movetoworkspacesilent, 7  # 静默移到第7个工作区
bind = $mainMod CTRL, code:17, movetoworkspacesilent, 8  # 静默移到第8个工作区
bind = $mainMod CTRL, code:18, movetoworkspacesilent, 9  # 静默移到第9个工作区
bind = $mainMod CTRL, code:19, movetoworkspacesilent, 10 # 静默移到第10个工作区
bind = $mainMod CTRL, bracketleft, movetoworkspacesilent, -1  # 静默移到上一个工作区
bind = $mainMod CTRL, bracketright, movetoworkspacesilent, +1 # 静默移到下一个工作区

# 使用滚动或方向键浏览工作区
bind = ALT, mouse_down, workspace, e+1          # 鼠标滚轮向下切换到下一个工作区
bind = ALT, mouse_up, workspace, e-1            # 鼠标滚轮向上切换到上一个工作区
bind = ALT, tab, workspace, e+1                 # 按Tab键切换到下一个工作区
bind = $mainMod, right, workspace, e+1          # 按右箭头切换到下一个工作区

# ┌─ 应用启动器快捷键区 ────────────────────────────────────────────────────────────────────────
# 应用启动器和快速访问
bindr = $mainMod, $mainMod_L, exec, pkill rofi || rofi -show drun -modi drun,filebrowser,run,window  # 按Win键打开应用启动器
bind = $mainMod, D, exec, pkill rofi || rofi -show drun -modi drun,filebrowser,run,window           # 按Win+D打开应用启动器

# 快速启动常用应用
bind = $mainMod, T, exec, $term                 # 按Win+T打开终端
bind = $mainMod, E, exec, $files                # 按Win+E打开文件管理器
bind = $mainMod shift, B, exec, firefox-nightly # 按Win+Shift+B打开Firefox Nightly浏览器
bind = $mainMod shift, C, exec, hyprpicker -a   # 按Win+Shift+C打开屏幕取色器

# ┌─ 系统和实用工具快捷键区 ────────────────────────────────────────────────────────────────────
# 系统控制
bind = CTRL ALT, Delete, exec, hyprctl dispatch exit 0  # 按Ctrl+Alt+Delete退出Hyprland
bind = CTRL ALT, O, exec, $scriptsDir/Wlogout.sh       # 按Ctrl+Alt+O打开注销菜单
bind = $mainMod, L, exec, hyprlock -q                  # 按Win+L锁定屏幕
bind = $mainMod, I, exec, kitty nvim $HOME/.config/hypr/hyprland.conf  # 按Win+I编辑此配置文件

# 系统命令
bind = CTRL $mainMod, R, exec, reboot           # 按Ctrl+Win+R重启系统
bind = CTRL $mainMod, P, exec, poweroff         # 按Ctrl+Win+P关闭系统

# 实用功能
bind = $mainMod ALT, R, exec, $scriptsDir/Refresh.sh  # 按Win+Alt+R刷新Waybar、SwayNC、Rofi
bind = $mainMod, S, exec, $scriptsDir/RofiSearch.sh   # 按Win+S打开Rofi网络搜索
bind = $mainMod, V, exec, $scriptsDir/ClipManager.sh  # 按Win+V打开剪贴板管理器
bind = $mainMod SHIFT, N, exec, swaync-client -t -sw  # 按Win+Shift+N切换通知中心面板

# 下拉终端和窗口管理
bind = $mainMod, K, exec, pypr toggle term      # 按Win+K切换下拉终端
bind = $mainMod, Z, exec, pypr zoom             # 按Win+Z切换窗口缩放/聚焦模式

# ┌─ 媒体和音频控制区 ──────────────────────────────────────────────────────────────────────────
# 音量控制
bind = , xf86audioraisevolume, exec, $scriptsDir/Volume.sh --inc      # 按音量增大键调节音量
bind = , xf86audiolowervolume, exec, $scriptsDir/Volume.sh --dec      # 按音量减小键调节音量
bind = , xf86audiomute, exec, $scriptsDir/Volume.sh --toggle          # 按静音键开关静音
bind = , xf86AudioMicMute, exec, $scriptsDir/Volume.sh --toggle-mic   # 按麦克风静音键开关麦克风

# 媒体播放控制
bind = , xf86AudioPlayPause, exec, $scriptsDir/MediaCtrl.sh --pause   # 按播放/暂停键控制媒体
bind = , xf86AudioPause, exec, $scriptsDir/MediaCtrl.sh --pause       # 按暂停键暂停媒体
bind = , xf86AudioPlay, exec, $scriptsDir/MediaCtrl.sh --pause        # 按播放键播放媒体
bind = , xf86AudioNext, exec, $scriptsDir/MediaCtrl.sh --nxt          # 按下一曲键切换到下一首
bind = , xf86AudioPrev, exec, $scriptsDir/MediaCtrl.sh --prv          # 按上一曲键切换到上一首
bind = , xf86audiostop, exec, $scriptsDir/MediaCtrl.sh --stop         # 按停止键停止媒体播放

# 特殊功能键
bind = , xf86Sleep, exec, systemctl suspend     # 按睡眠键使系统进入睡眠状态
bind = , xf86Rfkill, exec, $scriptsDir/AirplaneMode.sh  # 按飞行模式键开关飞行模式

# ┌─ 屏幕截图快捷键区 ──────────────────────────────────────────────────────────────────────────
# 截图功能
bind = SHIFT, Print, exec, $scriptsDir/ScreenShot.sh --now     # 按Shift+Print立即截图
bind = CTRL, Print, exec, $scriptsDir/ScreenShot.sh --area     # 按Ctrl+Print截取选定区域
bind = $mainMod CTRL, Print, exec, $scriptsDir/ScreenShot.sh --in5   # 按Win+Ctrl+Print 5秒后截图
bind = $mainMod ALT, Print, exec, $scriptsDir/ScreenShot.sh --in10  # 按Win+Alt+Print 10秒后截图
bind = ALT, Print, exec, $scriptsDir/ScreenShot.sh --active    # 按Alt+Print截取活动窗口
bind = $mainMod SHIFT, S, exec, $scriptsDir/ScreenShot.sh --swappy  # 按Win+Shift+S截图并编辑

# ┌─ 壁纸控制区 ────────────────────────────────────────────────────────────────────────────────
# 壁纸管理
bind = $mainMod, W, exec, $UserScripts/WallpaperSelect.sh      # 按Win+W选择新壁纸
bind = CTRL ALT, W, exec, $UserScripts/WallpaperRandom.sh     # 按Ctrl+Alt+W随机更换壁纸

# ┌─ 状态栏和UI控制区 ─────────────────────────────────────────────────────────────────────────
# Waybar状态栏控制
bind = $mainMod, B, exec, killall -SIGUSR1 waybar             # 按Win+B切换状态栏可见性
bind = $mainMod CTRL, B, exec, $scriptsDir/WaybarStyles.sh     # 按Win+Ctrl+B更改状态栏样式
bind = $mainMod ALT, B, exec, $scriptsDir/WaybarLayout.sh      # 按Win+Alt+B更改状态栏布局

# ┌─ 鼠标绑定区 ────────────────────────────────────────────────────────────────────────────────
# 鼠标操作用于窗口管理
bindm = SHIFT, mouse:272, movewindow           # 按住Shift+鼠标左键移动窗口
bindm = SHIFT, mouse:273, resizewindow         # 按住Shift+鼠标右键调整窗口大小

# ┌─ 触摸板手势区 ──────────────────────────────────────────────────────────────────────────────
# 三指手势用于工作区导航
gesture = 3, horizontal, workspace             # 三指向左右滑动切换工作区
gesture = 3, down, fullscreen, 0              # 三指下滑退出全屏
gesture = 3, up, fullscreen, 1                # 三指上滑进入全屏
gesture = 3, down, mod:CTRL, close             # 按住CTRL,三指下滑关闭窗口

# 四指应用手势
gesture = 4, down, mod:CTRL, dispatcher, exec, kitty  # 四指下滑+Ctrl打开终端
gesture = 4, up, mod:CTRL, dispatcher, exec, thunar   # 四指上滑+Ctrl打开文件管理器

# 截图手势
gesture = 3, down, mod:ALT, dispatcher, exec, $scriptsDir/ScreenShot.sh --swappy  # 三指下滑+Alt截图
gesture = 3, up, mod:ALT, dispatcher, exec, $scriptsDir/ScreenShot.sh --swappy    # 三指上滑+Alt截图

# ┌─ 环境变量区 ────────────────────────────────────────────────────────────────────────────────
# 为Wayland环境配置必要的环境变量
env = CLUTTER_BACKEND,wayland                  # 使Clutter应用在Wayland上运行
env = GDK_BACKEND,wayland,x11                  # 使GTK应用同时支持Wayland和X11
env = QT_AUTO_SCREEN_SCALE_FACTOR,1             # Qt应用自动适应屏幕缩放
env = QT_QPA_PLATFORM,wayland;xcb              # 使Qt应用在Wayland上运行
env = QT_QPA_PLATFORMTHEME,qt5ct               # Qt5应用主题设置
env = QT_QPA_PLATFORMTHEME,qt6ct               # Qt6应用主题设置
env = QT_SCALE_FACTOR,1                        # Qt应用缩放因子
env = QT_WAYLAND_DISABLE_WINDOWDECORATION,1    # 禁用Qt应用的窗口装饰
env = XDG_CURRENT_DESKTOP,Hyprland             # 当前桌面环境标识
env = XDG_SESSION_DESKTOP,Hyprland             # 会话桌面环境标识
env = XDG_SESSION_TYPE,wayland                 # 会话类型标识
env = MOZ_ENABLE_WAYLAND,1                     # 为Firefox启用Wayland支持
env = ELECTRON_OZONE_PLATFORM_HINT,auto        # 为Electron应用启用Wayland支持